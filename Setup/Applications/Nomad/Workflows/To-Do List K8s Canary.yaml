harnessApiVersion: '1.0'
type: CANARY
concurrencyStrategy: INFRA
envName: prod
failureStrategies:
- executionScope: WORKFLOW
  failureTypes:
  - APPLICATION_ERROR
  repairActionCode: ROLLBACK_WORKFLOW
  retryCount: 0
notificationRules:
- conditions:
  - FAILED
  executionScope: WORKFLOW
  notificationGroupAsExpression: false
  userGroupAsExpression: false
  userGroupNames:
  - Account Administrator
preDeploymentSteps:
- type: SHELL_SCRIPT
  name: Output Image Name
  properties:
    commandPath: null
    connectionAttributeName: null
    executeOnDelegate: true
    host: null
    outputVars: image
    publishAsVar: true
    scriptString: image=cassiesimage
    scriptType: BASH
    secretOutputVars: ''
    sshKeyRefName: null
    sweepingOutputName: build
    sweepingOutputScope: PIPELINE
    templateExpressions: null
    templateUuid: null
    templateVariables: null
    templateVersion: null
    timeoutMillis: 60000
- type: SHELL_SCRIPT
  name: Echo Image Name
  properties:
    commandPath: null
    connectionAttributeName: null
    executeOnDelegate: true
    host: null
    outputVars: ''
    publishAsVar: false
    scriptString: echo ${workflow.variables.DOCKER_IMAGE_NAME}
    scriptType: BASH
    sshKeyRefName: null
    sweepingOutputName: null
    sweepingOutputScope: null
    templateExpressions: null
    templateUuid: null
    templateVariables: null
    templateVersion: null
    timeoutMillis: 60000
templatized: true
userVariables:
- type: TEXT
  fixed: false
  mandatory: false
  name: DOCKER_IMAGE_NAME
  value: ${context.build.image}
